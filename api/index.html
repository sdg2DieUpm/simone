<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Simone: a game of visual memory and speed: Simone Project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Simone: a game of visual memory and speed
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Simone Project </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This project demonstrates how the project Simone works using an keyboard to measure the intensity to an object in a parking aid system mounted on a car. It uses a finite state machine (FSM) to control the keyboard sensor, an RGB light (RGB LED) to show the intensity, and a button to interact with the system.</p>
<p>This project is intended to be used with the MatrixMCU toolkit. The toolkit is available at GitHub: <a href="https://github.com/sdg2DieUpm/MatrixMCU">MatrixMCU</a>.</p>
<p><b>Click on the image</b> to see the video showing the Simone demo for Nucleo STM32:</p>
<p><a href="https://youtu.be/v-HXdcEtT_4" title="Simone Demo."><div class="image">
<img src="fritzing_simone.png" alt=""/>
<div class="caption">
Simone Demo</div></div>
    </a></p>
<p>You can access the documentation of the project at: <a href="https://sdg2dieupm.github.io/simone/">Simone Documentation</a>.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Version 1</h1>
<p>In Version 1, the system works with the user button only. The user button is connected to the pin PC13. The code uses the EXTI13 interrupt to detect the button press.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin </td><td class="markdownTableBodyNone">PC13  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Mode </td><td class="markdownTableBodyNone">Input  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pull up/ down </td><td class="markdownTableBodyNone">No push no pull  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">EXTI </td><td class="markdownTableBodyNone">EXTI13  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ISR </td><td class="markdownTableBodyNone">EXTI15_10_IRQHandler  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Priority </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Subpriority </td><td class="markdownTableBodyNone">0  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Debounce time </td><td class="markdownTableBodyNone">100-200 ms  </td></tr>
</table>
<p>You can start from the <a href="stm32f4__button_8c.html">HW dependent part of Version 1</a>.</p>
<ul>
<li>Here you can find the <b>project</b> with the basic configuration: <a href="https://github.com/sdg2DieUpm/simone">Simone Project</a>.</li>
<li>Here you can find the <b>test files</b> for Version 1: <a href="https://github.com/sdg2DieUpm/simone/tree/simone_v1_test">V1 test files</a></li>
</ul>
<p>This is the FSM of the button: </p><div class="image">
<img src="fsm_v1.png" alt=""/>
<div class="caption">
FSM of the button</div></div>
   <h1><a class="anchor" id="autotoc_md2"></a>
Version 2</h1>
<p>In Version 2, the system adds the keyboard matrix to read the presses of the player in the game.</p>
<p>The connections of the keyboard are shown in the table below:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin row 1 </td><td class="markdownTableBodyNone">PA0  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pin row 2 </td><td class="markdownTableBodyNone">PA1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin row 3 </td><td class="markdownTableBodyNone">PA4  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pin row 4 </td><td class="markdownTableBodyNone">PB0  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Mode rows </td><td class="markdownTableBodyNone">Output  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pull up/ down rows </td><td class="markdownTableBodyNone">No push, no pull  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Timeout excitation rows </td><td class="markdownTableBodyNone">25 ms  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pin/ EXTI/ ISR column 1 </td><td class="markdownTableBodyNone">PA8/ EXTI8/ EXTI9_5_IRQHandler  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin/ EXTI/ ISR column 2 </td><td class="markdownTableBodyNone">PB10/ EXTI10/ EXTI15_10_IRQHandler  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pin/ EXTI/ ISR column 3 </td><td class="markdownTableBodyNone">PB4/ EXTI4/ EXTI4_IRQHandler  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin/ EXTI/ ISR column 4 </td><td class="markdownTableBodyNone">PB5/ EXTI5/ EXTI9_5_IRQHandler  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Mode columns </td><td class="markdownTableBodyNone">Input  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pull up/ down columns </td><td class="markdownTableBodyNone">Pull down  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Priority all columns </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Subpriority all columns </td><td class="markdownTableBodyNone">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Debounce time all columns </td><td class="markdownTableBodyNone">100-200 ms  </td></tr>
</table>
<p>The system uses 1 timer to control the duration of the <b>excitation of each row</b> in the keyboard matrix. The characteristics of this timer are shown in the table below. The FSM will give a value every <code>PORT_KEYBOARDS_TIMEOUT_MS</code> milliseconds.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Timer </td><td class="markdownTableBodyNone">TIM5  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Prescaler </td><td class="markdownTableBodyNone">(to be calculated for <code>PORT_KEYBOARDS_TIMEOUT_MS</code>)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Period </td><td class="markdownTableBodyNone">(to be calculated for <code>PORT_KEYBOARDS_TIMEOUT_MS</code>)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ISR </td><td class="markdownTableBodyNone"><a class="el" href="interr_8c.html#a5e66446caf21dd90191dc07a13ce2378" title="Interrupt service routine for the TIM5 timer.">TIM5_IRQHandler()</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Priority </td><td class="markdownTableBodyNone">2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Subpriority </td><td class="markdownTableBodyNone">0  </td></tr>
</table>
<p>You can start from the <a href="stm32f4__keyboard_8c.html">HW dependent part of Version 2</a>.</p>
<ul>
<li>Here you can find the files needed for the control of the <b>keyboard</b>: <a href="https://github.com/sdg2DieUpm/simone/tree/simone_v2">Keyboard</a>.</li>
<li>Here you can find the <b>test files</b> for Version 2: <a href="https://github.com/sdg2DieUpm/simone/tree/simone_v2_test">V2 test files</a></li>
</ul>
<p>This is the FSM of the keyboard: </p><div class="image">
<object type="image/svg+xml" data="fsm_v2.svg" style="pointer-events: none;"></object>
<div class="caption">
FSM of the keyboard</div></div>
   <h1><a class="anchor" id="autotoc_md3"></a>
Version 3</h1>
<p>In Version 3, the system adds the RGB light, which is an RGB LED. The RGB LED is connected to the pins PB6 (red), PB8 (green), and PB9 (blue). The code uses the TIM4 timer to control the frequency of the <b>PWM</b> signal for each color. The RGB LED will show the intensity depending on the difficulty level. The characteristics of the RGB light are shown in the table below.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin LED red </td><td class="markdownTableBodyNone">PB6  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pin LED green </td><td class="markdownTableBodyNone">PB8  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin LED blue </td><td class="markdownTableBodyNone">PB9  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Mode </td><td class="markdownTableBodyNone">Alternative  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pull up/ down </td><td class="markdownTableBodyNone">No pull  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Timer </td><td class="markdownTableBodyNone">TIM4  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Channel LED red </td><td class="markdownTableBodyNone">(see the Alternate Function table in the datasheet)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Channel LED green </td><td class="markdownTableBodyNone">(see the Alternate Function table in the datasheet)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Channel LED blue </td><td class="markdownTableBodyNone">(see the Alternate Function table in the datasheet)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PWM mode </td><td class="markdownTableBodyNone">PWM mode 1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Prescaler </td><td class="markdownTableBodyNone">(to be calculated for a frequency of 50 Hz)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Period </td><td class="markdownTableBodyNone">(to be calculated for a frequency of 50 Hz)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Duty cycle LED red </td><td class="markdownTableBodyNone">(variable, depends on the color to show)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Duty cycle LED green </td><td class="markdownTableBodyNone">(variable, depends on the color to show)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Duty cycle LED blue </td><td class="markdownTableBodyNone">(variable, depends on the color to show)  </td></tr>
</table>
<p>You have a list full of colors in <a href="https://www.downtownuplighting.com/rgb-color-chart">www.downtownuplighting.com</a> although not all can be shown on an RGB LED.</p>
<p>You can start from the <a href="stm32f4__rgb_light_8c.html">HW dependent part of Version 3</a>.</p>
<ul>
<li>Here you can find the files needed for the control of the <b>RGB light</b>: <a href="https://github.com/sdg2DieUpm/simone/tree/simone_v3">RGB light</a>.</li>
<li>Here you can find the <b>test files</b> for Version 3: <a href="https://github.com/sdg2DieUpm/simone/tree/simone_v3_test">V3 test files</a></li>
</ul>
<p>This is the FSM of the RGB light: </p><div class="image">
<object type="image/svg+xml" data="fsm_v3.svg" style="pointer-events: none;"></object>
<div class="caption">
FSM of the RGB light</div></div>
   <h1><a class="anchor" id="autotoc_md4"></a>
Version 4</h1>
<p>In Version 4 the system completes its FSM to interact with the user button, the keyboard, and the RGB light. The system will work as a game where the player has to repeat a sequence of colors shown by the RGB light by pressing the corresponding keys on the keyboard. The system will increase the length of the sequence with each successful round, and it will provide visual feedback through the RGB light for correct and incorrect inputs.</p>
<p>There are no files for the FSM of Version 4, and you have to create them from scratch following the laboratory notebook. You can use the files of the previous versions as a reference.</p>
<p>Check the <a href="fsm__simone_8c.html">HW dependent part of Version 4</a>.</p>
<p>YOU MUST DRAW THE FSM OF THE SYSTEM BY YOURSELF AND PUT IT HERE.: <img src="docs/assets/notebook_imgs/image.png" alt="FSM of the system" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md5"></a>
Version 5</h1>
<p>In Version 5 the user adds its own functions to the system. Check the manual of the system to know how to add your own functions.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Getting Started</h1>
<p>Download this project and place it in the <code>projects</code> folder of the MatrixMCU toolkit.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Prerequisites</h2>
<p>Be sure that you fulfill the prerequisites of the MatrixMCU toolkit and it is up to date.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Document your code</h1>
<p>Watch this video to better understand how to document your code with <b>Doxygen</b>:</p>
<p><a href="https://youtu.be/VC7fExJJQSY?si=oIAZU_b2sRWhu3de" title="[MatrixMCU]. Documentación de código con Doxygen."><div class="image">
<img src="doxygen_thumb.png" alt=""/>
<div class="caption">
Link to Doxygen tutorial</div></div>
    </a></p>
<h1><a class="anchor" id="autotoc_md9"></a>
Authors</h1>
<ul>
<li><b>Josué Pagán</b> - email: <a href="#" onclick="location.href='mai'+'lto:'+'j.p'+'ag'+'an@'+'up'+'m.e'+'s'; return false;">j.pagan@upm.es</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
License</h1>
<p>This project is licensed under the MIT License - see the LICENSE file for details.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Acknowledgments</h1>
<p>Acknowledgments to all professors of the <b>SDG2</b> subject.</p>
<p><b>In memory of Mario Garrido Gálvez (1981-2025), a great professor and colleague. RIP.</b></p>
<h1><a class="anchor" id="autotoc_md12"></a>
References</h1>
<ul>
<li><b>[1]</b>: <a href="https://moodle.upm.es/titulaciones/oficiales/course/view.php?id=785#section-0">Documentation available in the Moodle of the course</a></li>
<li><b>[2]</b>: <a href="https://web.eece.maine.edu/~zhu/book/index.php">Embedded Systems with ARM Cortex-M Microcontrollers in Assembly Language and C (Fourth Edition)</a> for explanations and examples of use of the ARM Cortex-M microcontrollers in C with CMSIS.</li>
<li><b>[3]</b>: <a href="https://ingenio.upm.es/primo-explore/fulldisplay?docid=34UPM_ALMA51126621660004212&amp;context=L&amp;vid=34UPM_VU1&amp;lang=es_ES&amp;search_scope=TAB1_SCOPE1&amp;adaptor=Local%20Search%20Engine&amp;tab=tab1&amp;query=any,contains,Programming%20with%20STM32:%20Getting%20Started%20with%20the%20Nucleo%20Board%20and%20C%2FC%2B%2B&amp;offset=0">Programming with STM32: Getting Started with the Nucleo Board and C/C++</a> for examples of use of the STM32 microcontrollers with the HAL of ST.</li>
<li><b>[4]</b>: <a href="https://ingenio.upm.es/primo-explore/fulldisplay?docid=34UPM_ALMA2151866130004212&amp;context=L&amp;vid=34UPM_VU1&amp;lang=es_ES&amp;search_scope=TAB1_SCOPE1&amp;adaptor=Local%20Search%20Engine&amp;isFrbr=true&amp;tab=tab1&amp;query=any,contains,C%20Programming%20Language">The C Programming Language</a></li>
<li><b>[5]</b>: <a href="https://ingenio.upm.es/primo-explore/fulldisplay?docid=34UPM_ALMA21107789140004212&amp;context=L&amp;vid=34UPM_VU1&amp;lang=es_ES&amp;search_scope=TAB1_SCOPE1&amp;adaptor=Local%20Search%20Engine&amp;isFrbr=true&amp;tab=tab1&amp;query=any,contains,Aspectos%20pr%C3%A1cticos%20de%20dise%C3%B1o%20y%20medida%20en%20Laboratorios%20de%20Electr%C3%B3nica&amp;offset=0">Aspectos prácticos de diseño y medida en Laboratorios de Electrónica</a> for the use of the oscilloscope and the function generator.</li>
<li><b>[6]</b>: <a href="https://www.elektor.com/products/nucleo-boards-programming-with-the-stm32cubeide">Nucleo Boards Programming with th STM32CubeIDE</a> for examples of use of the STM32 microcontrollers with the STM32CubeIDE. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
