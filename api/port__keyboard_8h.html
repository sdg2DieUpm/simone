<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Simone: a game of visual memory and speed: port/include/port_keyboard.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Simone: a game of visual memory and speed
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('port__keyboard_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">port_keyboard.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header for the portable functions to interact with the HW of the keyboards. The functions must be implemented in the platform-specific code.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8bfef2249dc4b02bcc1642e845181764"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#a8bfef2249dc4b02bcc1642e845181764">PORT_KEYBOARD_MAIN_ID</a></td></tr>
<tr class="separator:a8bfef2249dc4b02bcc1642e845181764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6744d8b61d55fa5939822c737ce5ab71"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#a6744d8b61d55fa5939822c737ce5ab71">PORT_KEYBOARD_MAIN_TIMEOUT_MS</a></td></tr>
<tr class="separator:a6744d8b61d55fa5939822c737ce5ab71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a47a30313faeed849b0b9022e903d49"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#a4a47a30313faeed849b0b9022e903d49">PORT_KEYBOARD_MAIN_DEBOUNCE_TIME_MS</a></td></tr>
<tr class="separator:a4a47a30313faeed849b0b9022e903d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aabf2d76827913220d543d1660add5bc9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#aabf2d76827913220d543d1660add5bc9">port_keyboard_col_t</a> { <br />
&#160;&#160;<a class="el" href="port__keyboard_8h.html#aabf2d76827913220d543d1660add5bc9ad7745c0c6559e84374ceb2d98ebbb47a">PORT_KEYBOARD_COL_0</a>, 
<br />
&#160;&#160;<a class="el" href="port__keyboard_8h.html#aabf2d76827913220d543d1660add5bc9afd97501e44653025ddba88f1d6ffaefb">PORT_KEYBOARD_COL_1</a>, 
<br />
&#160;&#160;<a class="el" href="port__keyboard_8h.html#aabf2d76827913220d543d1660add5bc9a05eb7989252414d8d081f51b18ab7178">PORT_KEYBOARD_COL_2</a>, 
<br />
&#160;&#160;<a class="el" href="port__keyboard_8h.html#aabf2d76827913220d543d1660add5bc9a5aed44997b69e11f9b097ec51bff5c5e">PORT_KEYBOARD_COL_3</a>
<br />
 }</td></tr>
<tr class="memdesc:aabf2d76827913220d543d1660add5bc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration to define the columns indexes of the keyboard. This enumeration is used to identify the columns when handling the interrupts.  <a href="port__keyboard_8h.html#aabf2d76827913220d543d1660add5bc9">More...</a><br /></td></tr>
<tr class="separator:aabf2d76827913220d543d1660add5bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab6d73a385387a3fc0d0a2d2ded42e5d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#ab6d73a385387a3fc0d0a2d2ded42e5d8">port_keyboard_init</a> (uint8_t keyboard_id)</td></tr>
<tr class="memdesc:ab6d73a385387a3fc0d0a2d2ded42e5d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the HW specifications of a given keyboard.  <a href="port__keyboard_8h.html#ab6d73a385387a3fc0d0a2d2ded42e5d8">More...</a><br /></td></tr>
<tr class="separator:ab6d73a385387a3fc0d0a2d2ded42e5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Set the given row to high and lower the others.</p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Retrieve the keyboard configuration struct calling <code><a class="el" href="stm32f4__keyboard_8c.html#aa3330d22a2fcd66831baa9cdef648e48" title="Get the keyboard struct with the given ID.">_stm32f4_keyboard_get()</a></code> <br  />
âœ… 2. Iterate through all the rows indexes (you can get the number of rows from the keyboard's layout). In the iteration, if the row coincides with the row index, set it HIGH. Otherwise, set it to LOW to ensure that only one row is excited at the same time. &#160;&#160;&#160;&#160;ðŸ’¡ You can use the <code>BSRR</code> or call the <code><a class="el" href="stm32f4__system_8h.html#af46cdd939024e157ed6f7468edaee4e3" title="Write a digital value in a GPIO atomically.">stm32f4_system_gpio_write()</a></code> function. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>ID of the keyboard to be scanned. </td></tr>
    <tr><td class="paramname">row_idx</td><td>Index of the row to be excited. </td></tr>
  </table>
  </dd>
</dl>
</div></td></tr>
<tr class="memitem:a1ca9463c0c87fa80c6a08c5d71d23d4f"><td class="memItemLeft" align="right" valign="top"><a id="a1ca9463c0c87fa80c6a08c5d71d23d4f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>port_keyboard_excite_row</b> (uint8_t keyboard_id, uint8_t row_idx)</td></tr>
<tr class="separator:a1ca9463c0c87fa80c6a08c5d71d23d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1320216867d7f6b27a77b4a597243b95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#a1320216867d7f6b27a77b4a597243b95">port_keyboard_start_scan</a> (uint8_t keyboard_id)</td></tr>
<tr class="memdesc:a1320216867d7f6b27a77b4a597243b95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the scanning of a keyboard.  <a href="port__keyboard_8h.html#a1320216867d7f6b27a77b4a597243b95">More...</a><br /></td></tr>
<tr class="separator:a1320216867d7f6b27a77b4a597243b95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad52eeaf12ebfbd2faf6c944fc4f69600"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#ad52eeaf12ebfbd2faf6c944fc4f69600">port_keyboard_stop_scan</a> (uint8_t keyboard_id)</td></tr>
<tr class="memdesc:ad52eeaf12ebfbd2faf6c944fc4f69600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the scanning of a keyboard.  <a href="port__keyboard_8h.html#ad52eeaf12ebfbd2faf6c944fc4f69600">More...</a><br /></td></tr>
<tr class="separator:ad52eeaf12ebfbd2faf6c944fc4f69600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ff0a28d6cad5c0b67c4bc2f37cc2d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#a76ff0a28d6cad5c0b67c4bc2f37cc2d2">port_keyboard_excite_next_row</a> (uint8_t keyboard_id)</td></tr>
<tr class="memdesc:a76ff0a28d6cad5c0b67c4bc2f37cc2d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the row to be excited.  <a href="port__keyboard_8h.html#a76ff0a28d6cad5c0b67c4bc2f37cc2d2">More...</a><br /></td></tr>
<tr class="separator:a76ff0a28d6cad5c0b67c4bc2f37cc2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d95c098d9ce87863ae191c65246830"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#ad9d95c098d9ce87863ae191c65246830">port_keyboard_get_key_pressed_status</a> (uint8_t keyboard_id)</td></tr>
<tr class="memdesc:ad9d95c098d9ce87863ae191c65246830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the status of the keyboard (pressed or not).  <a href="port__keyboard_8h.html#ad9d95c098d9ce87863ae191c65246830">More...</a><br /></td></tr>
<tr class="separator:ad9d95c098d9ce87863ae191c65246830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f06120b963a9aeda74ee26f3595478"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#ac0f06120b963a9aeda74ee26f3595478">port_keyboard_set_key_pressed_status</a> (uint8_t keyboard_id, bool status)</td></tr>
<tr class="memdesc:ac0f06120b963a9aeda74ee26f3595478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the status of the keyboard (pressed or not).  <a href="port__keyboard_8h.html#ac0f06120b963a9aeda74ee26f3595478">More...</a><br /></td></tr>
<tr class="separator:ac0f06120b963a9aeda74ee26f3595478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b195430e43df585ddebe86f06a2cdc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#a82b195430e43df585ddebe86f06a2cdc">port_keyboard_get_row_timeout_status</a> (uint8_t keyboard_id)</td></tr>
<tr class="memdesc:a82b195430e43df585ddebe86f06a2cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the status of the column timeout flag.  <a href="port__keyboard_8h.html#a82b195430e43df585ddebe86f06a2cdc">More...</a><br /></td></tr>
<tr class="separator:a82b195430e43df585ddebe86f06a2cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae652d3e4324278a555817e5cdfc128a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#ae652d3e4324278a555817e5cdfc128a5">port_keyboard_set_row_timeout_status</a> (uint8_t keyboard_id, bool status)</td></tr>
<tr class="memdesc:ae652d3e4324278a555817e5cdfc128a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the status of the row timeout flag.  <a href="port__keyboard_8h.html#ae652d3e4324278a555817e5cdfc128a5">More...</a><br /></td></tr>
<tr class="separator:ae652d3e4324278a555817e5cdfc128a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e84e1f30a5de2c507f98f9a9972a8d0"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__keyboard_8h.html#a5e84e1f30a5de2c507f98f9a9972a8d0">port_keyboard_get_key_value</a> (uint8_t keyboard_id)</td></tr>
<tr class="memdesc:a5e84e1f30a5de2c507f98f9a9972a8d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the char representing the key pressed of a given keyboard based on its row that is being excited. This assumes that the matrix of chars is flattened (i.e., it is not a 2D array, but all rows are in a single array), thus it is necessary to calculate only one index.  <a href="port__keyboard_8h.html#a5e84e1f30a5de2c507f98f9a9972a8d0">More...</a><br /></td></tr>
<tr class="separator:a5e84e1f30a5de2c507f98f9a9972a8d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header for the portable functions to interact with the HW of the keyboards. The functions must be implemented in the platform-specific code. </p>
<dl class="section author"><dt>Author</dt><dd>Sistemas Digitales II </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2026-01-01 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4a47a30313faeed849b0b9022e903d49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a47a30313faeed849b0b9022e903d49">&#9670;&nbsp;</a></span>PORT_KEYBOARD_MAIN_DEBOUNCE_TIME_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_KEYBOARD_MAIN_DEBOUNCE_TIME_MS</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Keyboard's keys debounce time in milliseconds </p>

</div>
</div>
<a id="a8bfef2249dc4b02bcc1642e845181764"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bfef2249dc4b02bcc1642e845181764">&#9670;&nbsp;</a></span>PORT_KEYBOARD_MAIN_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_KEYBOARD_MAIN_ID</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Keyboard identifier that represents the keyboard of the system </p>

</div>
</div>
<a id="a6744d8b61d55fa5939822c737ce5ab71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6744d8b61d55fa5939822c737ce5ab71">&#9670;&nbsp;</a></span>PORT_KEYBOARD_MAIN_TIMEOUT_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_KEYBOARD_MAIN_TIMEOUT_MS</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Keyboard scanning timeout in milliseconds </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aabf2d76827913220d543d1660add5bc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabf2d76827913220d543d1660add5bc9">&#9670;&nbsp;</a></span>port_keyboard_col_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="port__keyboard_8h.html#aabf2d76827913220d543d1660add5bc9">port_keyboard_col_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration to define the columns indexes of the keyboard. This enumeration is used to identify the columns when handling the interrupts. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aabf2d76827913220d543d1660add5bc9ad7745c0c6559e84374ceb2d98ebbb47a"></a>PORT_KEYBOARD_COL_0&#160;</td><td class="fielddoc"><p>First column of the keyboard </p>
</td></tr>
<tr><td class="fieldname"><a id="aabf2d76827913220d543d1660add5bc9afd97501e44653025ddba88f1d6ffaefb"></a>PORT_KEYBOARD_COL_1&#160;</td><td class="fielddoc"><p>Second column of the keyboard </p>
</td></tr>
<tr><td class="fieldname"><a id="aabf2d76827913220d543d1660add5bc9a05eb7989252414d8d081f51b18ab7178"></a>PORT_KEYBOARD_COL_2&#160;</td><td class="fielddoc"><p>Third column of the keyboard </p>
</td></tr>
<tr><td class="fieldname"><a id="aabf2d76827913220d543d1660add5bc9a5aed44997b69e11f9b097ec51bff5c5e"></a>PORT_KEYBOARD_COL_3&#160;</td><td class="fielddoc"><p>Fourth column of the keyboard </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a76ff0a28d6cad5c0b67c4bc2f37cc2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ff0a28d6cad5c0b67c4bc2f37cc2d2">&#9670;&nbsp;</a></span>port_keyboard_excite_next_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_keyboard_excite_next_row </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the row to be excited. </p>
<blockquote class="doxtable">
<p>âœ… 1. Update the <code>current_excited_row</code> to move to the next row. If the index equals or greater than the number of rows <b>indicated in the layout</b>, move to the first row. <br  />
&#160;&#160;&#160;&#160;ðŸ’¡ You can use the <code>%</code> (modulo) operator to get the remainder of the division <br  />
âœ… 2. Call the function <code>port_keyboard_excite_row()</code> to excite the new row. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to get the correct keyboard status struct. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad9d95c098d9ce87863ae191c65246830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d95c098d9ce87863ae191c65246830">&#9670;&nbsp;</a></span>port_keyboard_get_key_pressed_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool port_keyboard_get_key_pressed_status </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the status of the keyboard (pressed or not). </p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Return the value of the field <code>flag_key_pressed</code>. Call the function <code><a class="el" href="stm32f4__keyboard_8c.html#aa3330d22a2fcd66831baa9cdef648e48" title="Get the keyboard struct with the given ID.">_stm32f4_keyboard_get()</a></code> to get the keyboard struct. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to get the correct keyboard status struct.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true If the keyboard has been pressed </dd>
<dd>
false If the keyboard has not been pressed </dd></dl>

</div>
</div>
<a id="a5e84e1f30a5de2c507f98f9a9972a8d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e84e1f30a5de2c507f98f9a9972a8d0">&#9670;&nbsp;</a></span>port_keyboard_get_key_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char port_keyboard_get_key_value </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the char representing the key pressed of a given keyboard based on its row that is being excited. This assumes that the matrix of chars is flattened (i.e., it is not a 2D array, but all rows are in a single array), thus it is necessary to calculate only one index. </p>
<blockquote class="doxtable">
<p>âœ… 1. Determine the value (char) of the key pressed based on the index of the current scanned row and the index of the column that provoked the interrupt, and return it. <br  />
&#160;&#160;&#160;&#160;ðŸ’¡ You can calculate the key index as: <code>key index = (excited row * num columns) + column interrupting</code>. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to get the correct keyboard status struct. </td></tr>
    <tr><td class="paramname">row_index</td><td>Index of the row being excited. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>char Key value of the key pressed. </dd></dl>

</div>
</div>
<a id="a82b195430e43df585ddebe86f06a2cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b195430e43df585ddebe86f06a2cdc">&#9670;&nbsp;</a></span>port_keyboard_get_row_timeout_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool port_keyboard_get_row_timeout_status </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the status of the column timeout flag. </p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Return the value of the field <code>flag_row_timeout</code>. Call the function <code><a class="el" href="stm32f4__keyboard_8c.html#aa3330d22a2fcd66831baa9cdef648e48" title="Get the keyboard struct with the given ID.">_stm32f4_keyboard_get()</a></code> to get the keyboard struct. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to get the correct keyboard status struct. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true If the column timeout has occurred </dd>
<dd>
false If the column timeout has not occurred </dd></dl>

</div>
</div>
<a id="ab6d73a385387a3fc0d0a2d2ded42e5d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6d73a385387a3fc0d0a2d2ded42e5d8">&#9670;&nbsp;</a></span>port_keyboard_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_keyboard_init </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the HW specifications of a given keyboard. </p>
<p>Assuming we are using an STM32F4-based platform, this function must call the following functions:</p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Retrieve the keyboard configuration struct calling <code><a class="el" href="stm32f4__keyboard_8c.html#aa3330d22a2fcd66831baa9cdef648e48" title="Get the keyboard struct with the given ID.">_stm32f4_keyboard_get()</a></code> <br  />
âœ… 2. Call function <code><a class="el" href="stm32f4__system_8h.html#aca348a9998b93751c1440d62050b7d79" title="Configure the mode and pull of a GPIO.">stm32f4_system_gpio_config()</a></code> with the right arguments to configure the rows as outputs with no pull up neither pull down connections (you can get the number of rows from the keyboard's layout). <br  />
âœ… 3. Call function <code><a class="el" href="stm32f4__system_8h.html#aca348a9998b93751c1440d62050b7d79" title="Configure the mode and pull of a GPIO.">stm32f4_system_gpio_config()</a></code> with the right arguments to configure the columns as inputs with pull down connections. Call also function <code><a class="el" href="stm32f4__system_8h.html#a98f4105a82f32c645f0b06424af5ef22" title="Configure the external interruption or event of a GPIO.">stm32f4_system_gpio_config_exti()</a></code> with the right parameters to to configure interruption mode in rising edge and enabling the interrupt line for each column. Finally, call function <code><a class="el" href="stm32f4__system_8h.html#a03d8c69cd44964e3f1ff05a2c79626b8" title="Enable interrupts of a GPIO line (pin).">stm32f4_system_gpio_exti_enable()</a></code> with priority level to <code>1</code> and the subpriority level to <code>1</code> for all columns. All keyboards will have the same priority levels for their columns in the basic implementation. You can get the number of columns from the keyboard's layout. <br  />
âœ… 4. Clean/set all the fields of the keyboard struct to their initial values. Set the value of <code>current_excited_row</code> to <code>-1</code> to indicate that no row is being excited at the beginning. <br  />
âœ… 5. Configure the timer that controls the duration of the column scanning by calling the function <code><a class="el" href="stm32f4__keyboard_8c.html#a02d1f396d821890ec121fde3292f3ed4" title="Configure the timer that controls the duration of the column scanning.">_timer_scan_column_config()</a></code> <br  />
</p>
</blockquote>
<blockquote class="doxtable">
<p>&#160;&#160;&#160;&#160;ðŸ’¡ If any of the IRQs associated with the EXTI lines of the columns coincides with other IRQs in the system, the priority levels of this IRQ will be equal to the priority levels of the other peripheral. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to select the element of the <code>keyboards_arr[]</code> array </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac0f06120b963a9aeda74ee26f3595478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0f06120b963a9aeda74ee26f3595478">&#9670;&nbsp;</a></span>port_keyboard_set_key_pressed_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_keyboard_set_key_pressed_status </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the status of the keyboard (pressed or not). </p>
<p>This function is used to update the status of the keyboard when a key press is detected or cleared.</p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Set the value of the field <code>flag_key_pressed</code> to the given status. Call the function <code><a class="el" href="stm32f4__keyboard_8c.html#aa3330d22a2fcd66831baa9cdef648e48" title="Get the keyboard struct with the given ID.">_stm32f4_keyboard_get()</a></code> to get the keyboard struct. <br  />
 </p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td></td></tr>
    <tr><td class="paramname">status</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae652d3e4324278a555817e5cdfc128a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae652d3e4324278a555817e5cdfc128a5">&#9670;&nbsp;</a></span>port_keyboard_set_row_timeout_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_keyboard_set_row_timeout_status </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the status of the row timeout flag. </p>
<p>This function is used to update the status of the row timeout flag when a timeout occurs or is cleared.</p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Set the value of the field <code>flag_row_timeout</code> to the given status. Call the function <code><a class="el" href="stm32f4__keyboard_8c.html#aa3330d22a2fcd66831baa9cdef648e48" title="Get the keyboard struct with the given ID.">_stm32f4_keyboard_get()</a></code> to get the keyboard struct. <br  />
 </p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to get the correct keyboard status struct. </td></tr>
    <tr><td class="paramname">status</td><td>New status of the row timeout flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1320216867d7f6b27a77b4a597243b95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1320216867d7f6b27a77b4a597243b95">&#9670;&nbsp;</a></span>port_keyboard_start_scan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_keyboard_start_scan </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the scanning of a keyboard. </p>
<p>This function starts the scanning of a keyboard by enabling the timer that controls the duration of the column scanning and setting the first row to HIGH.</p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Reset the <code>flag_row_timeout</code> to indicate that a new scan is starting. <br  />
âœ… 2. Reset the counter (<code>CNT</code>) of the timer. <br  />
âœ… 3. Set the first row to be excited to HIGH and the others to LOW. You must use the appropiate function to do it. <br  />
âœ… 4. Enable the timer interrupt in the NVIC using the <code>NVIC_EnableIRQ()</code> function and the <code>TIMx_IRQn</code> interrupt. âœ… 5. Enable the counter of the timer (register <code>CR1</code> of the timer) to start the column scanning. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to get the correct keyboard status struct. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad52eeaf12ebfbd2faf6c944fc4f69600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad52eeaf12ebfbd2faf6c944fc4f69600">&#9670;&nbsp;</a></span>port_keyboard_stop_scan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_keyboard_stop_scan </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keyboard_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the scanning of a keyboard. </p>
<blockquote class="doxtable">
<p><b>TODO alumnos:</b></p>
<p>âœ… 1. Disable the counter of the timer (register <code>CR1</code> of the timer) to stop the column scanning. <br  />
âœ… 2. Disable the timer interrupt in the NVIC using the <code>NVIC_DisableIRQ()</code> function and the <code>TIMx_IRQn</code> interrupt. <br  />
âœ… 3. Set all rows to LOW. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyboard_id</td><td>Keyboard ID. This index is used to get the correct keyboard status struct. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_651562d8bf6cfd3e81eff5b570d7df50.html">port</a></li><li class="navelem"><a class="el" href="dir_3b4aa3705552218a151a51dac694657d.html">include</a></li><li class="navelem"><a class="el" href="port__keyboard_8h.html">port_keyboard.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
