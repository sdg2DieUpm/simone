
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sdg2dieupm.github.io/simone/notebook/version_4_old/">
      
      
      
      
      <link rel="icon" href="../../assets/general/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Versión 4: modos de bajo consumo e integración final - Laboratorio de Sistemas Digitales II</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/notebook-extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue_grey" data-md-color-accent="deep_orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cha:version4" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Laboratorio de Sistemas Digitales II" class="md-header__button md-logo" aria-label="Laboratorio de Sistemas Digitales II" data-md-component="logo">
      
  <img src="../../assets/notebook_imgs/general/etsit.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Laboratorio de Sistemas Digitales II
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Versión 4: modos de bajo consumo e integración final
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue_grey" data-md-color-accent="deep_orange"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue_grey" data-md-color-accent="deep_orange"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Laboratorio de Sistemas Digitales II" class="md-nav__button md-logo" aria-label="Laboratorio de Sistemas Digitales II" data-md-component="logo">
      
  <img src="../../assets/notebook_imgs/general/etsit.png" alt="logo">

    </a>
    Laboratorio de Sistemas Digitales II
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Portada
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Introducción general
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introducción general
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción a SDG2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sesion_introduccion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sesión de introducción
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Proyecto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Proyecto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proyecto_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proyecto base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../version_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versión 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../version_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versión 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../version_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versión 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../version_4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versión 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../version_5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versión 5
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentación API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Apéndices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Apéndices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BOM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Acrónimos
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Acrónimos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acronimos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acrónimos
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modos-de-bajo-consumo" class="md-nav__link">
    <span class="md-ellipsis">
      Modos de bajo consumo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sec:fsm_simone_1" class="md-nav__link">
    <span class="md-ellipsis">
      Integración final
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-cabecera-de-la-fsm-de-simone" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON: cabecera de la FSM de Simone
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-implementacion-de-la-fsm-de-simone" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON: implementación de la FSM de Simone
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sec:v2_integration" class="md-nav__link">
    <span class="md-ellipsis">
      Integración SW de la FSM Simone
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-de-integracion-de-la-simone" class="md-nav__link">
    <span class="md-ellipsis">
      Test de integración de la Simone
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cha:version4">Versión 4: modos de bajo consumo e integración final<a class="headerlink" href="#cha:version4" title="Permanent link">&para;</a></h1>
<div class="admonition example">
<p class="admonition-title">Bibliografía</p>
<ol>
<li>
<p><em>"Fundamentos teóricos de sistemas basados en microcontrolador STM32”</em> <sup id="fnref2:stm322025fundamentos"><a class="footnote-ref" href="#fn:stm322025fundamentos">1</a></sup></p>
</li>
<li>
<p><em>User Manual "UM1724. STM32 Nucleo-64 boards.”</em> <sup id="fnref2:st2020um"><a class="footnote-ref" href="#fn:st2020um">2</a></sup></p>
</li>
</ol>
</div>
<div class="admonition info">
<p class="admonition-title"><a href="https://www.youtube.com/channel/UCYIw_gl745WMJ1n0MamDzQw/">Vídeos del canal de SDGII</a></p>
<ul>
<li>
<p><a href="#TO-DO">Demostración Simone</a></p>
</li>
<li>
<p><a href="https://youtu.be/VC7fExJJQSY?si=YIY22n5yiqzfZuQd">"[MatrixMCU] Documentación de código con Doxygen”</a></p>
</li>
</ul>
</div>
<h2 id="modos-de-bajo-consumo">Modos de bajo consumo<a class="headerlink" href="#modos-de-bajo-consumo" title="Permanent link">&para;</a></h2>
<p>Ya tenemos todos los elementos del sistema para que sea funcional. Quizás quisiéramos —si se hace el diseño correspondiente— diseñar una <a href="../acronimos/#acro:PCB"><strong>PCB</strong></a> para desplegarlo en algún sitio. Si hiciésemos esto, muy seguramente alimentaríamos el dispositivo con una batería. Si midiésemos el consumo con un amperímetro, podríamos calcular la autonomía de nuestro sistema. Se habrá fijado que en los dispositivos comerciales como relojes inteligentes, mandos de TV, dispositivos <a href="../acronimos/#acro:IoT"><strong>IoT</strong></a>…la autonomía puede superar de largo varios meses con un uso normal del mismo. Para conseguir esto contamos con los <strong>modos de bajo consumo</strong>. Buena parte de los microcontroladores que hoy en día se precien cuentan con distintos modos de bajo consumo. <strong>Lea la sección <em>"Modos de bajo consumo”</em> del libro de Fundamentos Teóricos <sup id="fnref:stm322025fundamentos"><a class="footnote-ref" href="#fn:stm322025fundamentos">1</a></sup>.</strong></p>
<p>En esta versión, antes de hacer la integración final, vamos a implementar unas pocas funciones para gestionar el <strong>modo <em>sleep</em></strong> de bajo consumo en nuestro sistema. Esto se destaca en 2 estados de la FSM de <em>Simone</em> que veremos más adelante y que se muestran en la : <code>SLEEP_WHILE_ON</code>, y <code>SLEEP_WHILE_OFF</code>. Estos estados comprueban si alguna de las FSM de los elementos está, o no, activa, y en caso de que todas estén inactivas, <em>se va a dormir</em>. El sistema <em>se despertará</em> ante alguna interrupción de un <em>timer</em> o interrupción externa (pulsación de botón).</p>
<p>Antes de empezar a implementar las funciones de bajo consumo vamos a partir de una serie de consideraciones de la FSM. En la siguiente sección se detallan mucho más los estados, pero por ahora, nos fijamos en lo relativo al bajo consumo:</p>
<ul>
<li>
<p>En bajo consumo desactivaremos el <strong>SysTick</strong> para que no despierte al sistema cada <span class="arithmatex">\(1 ms\)</span>. Así pues, el contador del sistema no aumenta mientras se está <em>dormido</em>.</p>
</li>
<li>
<p>Las ISR que generan interrupciones externas —<em>botón</em> y <em>transceptor ultrasonidos</em>— son las encargadas de reactivar el <strong>SysTick</strong>.</p>
</li>
<li>
<p>La FSM del <em>botón</em> está inactiva en el estado <code>BUTTON_RELEASED</code>.</p>
</li>
<li>
<p>La FSM del <em>transceptor de ultrasonidos</em> está inactiva siempre, pues el dispositivo "solo está <em>funcionando</em>” cuando hay interrupciones del temporizador del <em>trigger</em>, o del <em>input capture</em> del <em>echo</em>. No es bloqueante.</p>
</li>
<li>
<p>La FSM del <em>RGB light</em> está activa si el <em>status</em> indica que está <em>funcionando</em>, y no está ocioso (<em>idle</em>).</p>
</li>
<li>
<p>Las autotransiciones de los estados de la FSM <em>Simone</em> (<code>SLEEP_WHILE_ON</code> y <code>SLEEP_WHILE_OFF</code>) están pensados para cuando esté trabajando en depuración. El depurador genera interrupciones en la ejecución del código que despiertan a nuestro sistema. Como no se trata de interrupciones de nuestros elementos, no pasaremos a los estados, pero debemos dormirnos mientras no se detenga el depurador de nuevo en otro <em>breakpoint</em>. Este es el cometido de dichas autotransiciones.</p>
</li>
</ul>
<p><strong>Procedamos.</strong> Como siempre, tenga abierta la página web de la <a href="../acronimos/#acro:API"><strong>API</strong></a> <a href="https://sdg2dieupm.github.io/simone/">https://sdg2dieupm.github.io/simone/</a>, ahí están todos los detalles de implementación. Vamos a tocar varios ficheros pero no crearemos ninguno nuevo.</p>
<p>Vamos a añadir las funciones de comprobación específicas de cada máquina de estados.</p>
<ol>
<li>
<p>En <code>fsm_button.c</code>: Añade la función <code>fsm_button_check_activity()</code> y su prototipo y documentación del código en <code>fsm_button.h</code>.</p>
</li>
<li>
<p>En <code>fsm_keyboard.c</code> añade la función <code>fsm_ultrasound_check_activity()</code> y su prototipo y documentación del código en <code>fsm_keyboard.h</code>.</p>
</li>
<li>
<p>En <code>fsm_rgb_light.c</code> añade la función <code>fsm_rgb_light_check_activity()</code> y su prototipo y documentación en <code>fsm_rgb_light.h</code>.</p>
</li>
</ol>
<p>Para terminar, vamos a añadir las funciones HW específicas de manejo del modo <em>stop</em> y <em>sleep</em> en nuestro <span style="color: RoyalBlue; font-weight: bold;">STM32F446RE</span>. Primero añadiremos algunas funciones generales del sistema en <code>stm32f4_system.c</code>; luego las modificaciones necesarias para restablecer el reloj de sistema <strong>SysTick</strong> tras una interrupción del <em>botón</em> o del <em>transceptor de ultrasonidos</em>, o de temporizador.</p>
<p>En <code>stm32f4_system.c</code>:</p>
<ol>
<li>
<p>Copia el código de <code>port_system_power_stop()</code> y <code>port_system_power_sleep()</code> de la API. Por tener un orden, puede hacerlo en una parte dedicada a <em>POWER RELATED FUNCTIONS</em>.</p>
</li>
<li>
<p>Copia el código de <code>port_system_systick_suspend()</code> de la API. Por tener un orden, puede hacerlo en la parte dedicada a <em>TIMER RELATED FUNCTIONS</em>.</p>
</li>
<li>
<p>Copia el código de <code>port_system_systick_resume()</code> de la API. Por tener un orden, puede hacerlo también en la parte dedicada a <em>TIMER RELATED FUNCTIONS</em>.</p>
</li>
<li>
<p>Implementa la función <code>port_system_sleep()</code> como indica la API. Por tener un orden, puede hacerlo junto con las anteriores en la parte dedicada a <em>POWER RELATED FUNCTIONS</em>.</p>
</li>
</ol>
<p>En <code>port_system.h</code>:</p>
<ol>
<li>Añade los prototipos de las funciones anteriores y su documentación.</li>
</ol>
<p>En el fichero en el que se encuentran nuestras ISR, <code>interr.c</code>.</p>
<ol>
<li>
<p>Añade al principio de la ISR del botón la llamada a <code>port_system_systick_resume()</code> para reactivar el contador del sistema <strong>SysTick</strong>, inmediatamente, tras la interrupción de pulsación (en estado inactivo el botón no está pulsado, por eso no estará durmiendo si el botón permanece pulsado).</p>
</li>
<li>
<p>Haz lo mismo en la ISR del <em>echo</em> del transceptor de ultrasonidos, <code>TIM2_IRQHandler()</code>.</p>
</li>
</ol>
<p>¡Ya tenemos un sistema eficiente energéticamente! En el futuro ten siempre en consideración la importancia de estos modos de bajo consumo en cualquier sistema embebido que se alimente con baterías. Vamos a unir todas las piezas.</p>
<h2 id="sec:fsm_simone_1">Integración final<a class="headerlink" href="#sec:fsm_simone_1" title="Permanent link">&para;</a></h2>
<p>Ya tenemos todos los módulos de las versiones V1-V3 de <em>Simone</em> desarrollados y probados: botón, transceptor de ultrasonidos y RGB light (LED) <span style="color: red; font-weight: bold;">R</span><span style="color: green; font-weight: bold;">G</span><span style="color: blue; font-weight: bold;">B</span>. Ahora vamos a integrarlos en el sistema central, y rellenar el <code>main.c</code> del programa. <strong>Procedamos</strong>:</p>
<p>La máquina de estados del sistema <em>Simone</em> involucra a todos los elementos del mismo y la gestión del bajo consumo. Al ser una implementación puramente lógica y no intervenir aquí ningún elemento HW, todo será desarrollo de la parte <code>COMMON</code>.</p>
<h5 id="consideraciones-de-la-fsm-de-simone">Consideraciones de la FSM de Simone<a class="headerlink" href="#consideraciones-de-la-fsm-de-simone" title="Permanent link">&para;</a></h5>
<h5 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h5>
<p>Antes de empezar vamos a partir de una serie de consideraciones.</p>
<ul>
<li>
<p>La FSM <strong>contiene en su estructura las máquinas de estados del resto de elementos del sistema</strong>.</p>
</li>
<li>
<p>Es <em>Simone</em> quién define qué es una pulsación larga, o corta. Recuerde que la pulsación larga del botón nos indicará el inicio de la marcha atrás y por tanto el arranque del sistema de aparcamiento <em>Simone</em>, y la pulsación corta servirá para pausar el RGB light.</p>
</li>
<li>
<p>Es esta FSM quién gestiona si el sistema está en pausa, o no.</p>
</li>
<li>
<p>La FSM es única, por lo que <strong>no es necesario</strong> tener información de identificador.</p>
</li>
<li>
<p>Es la FSM del sistema <em>Simone</em> quién pregunta a los distintos módulos su estado y gestiona la activación del modo de bajo consumo.</p>
</li>
</ul>
<p>La muestra los estados de la FSM de <em>Simone</em>. Ya podemos comprobar que el sistema <em>Simone</em> se enciende y apaga correctamente (meter y quitar la marcha atrás). Ahora <strong>crearemos los ficheros de partida</strong>. En esta ocasión no hay plantilla de descarga, así que vamos a crear los ficheros nosotros mismos:</p>
<ol>
<li>
<p>Crea el fichero <code>fsm_simone.h</code> en la carpeta correspondiente de <code>COMMON</code>. Este fichero contendrá la cabecera de la FSM de <em>Simone</em>. <strong>Pon las protecciones del fichero para evitar múltiples inclusiones</strong>, para lo que tienes que añadir las directivas de precompilador <code>#ifndef</code>, <code>#define</code>, y <code>#endif</code>, como se ha hecho en las versiones anteriores.</p>
</li>
<li>
<p>Crea el fichero <code>fsm_simone.c</code> en la carpeta correspondiente de <code>COMMON</code>. Este fichero contendrá la implementación de la FSM de <em>Simone</em>.</p>
</li>
</ol>
<p>Vamos a empezar por la cabecera de la FSM de <em>Simone</em>.</p>
<h2 id="common-cabecera-de-la-fsm-de-simone"><code>COMMON</code>: cabecera de la FSM de Simone<a class="headerlink" href="#common-cabecera-de-la-fsm-de-simone" title="Permanent link">&para;</a></h2>
<p>Abre el fichero <code>fsm_simone.h</code> y procedamos.</p>
<ol>
<li>
<p>Incluye las librerías necesarias según indica la API.</p>
</li>
<li>
<p>Seguidamente crea el enumerado <code>FSM_SIMONE</code> con los estados de la .</p>
</li>
<li>
<p>Seguidamente <strong>declararemos</strong> la estructura <code>fsm_simone_t</code> para hacerla pública. No obstante, no vamos definir sus campos públicamente.</p>
</li>
<li>
<p>Incluye los prototipos de las funciones públicas de la FSM según indica la API.</p>
</li>
<li>
<p>Documenta las funciones, enumerado y tipo nuevo. No olvides incluir el encabezado del fichero con su nombre y la fecha.</p>
</li>
</ol>
<figure><embed src="../assets/notebook_imgs/pr_chapters/version_4/fsm_simone_t.pdf" id="fig:fsm_simone_t" style="width:45.0%" /><figcaption aria-hidden="true">Estructura de la FSM de <em>Simone</em> en <code>COMMON</code>.</figcaption></figure>

<h2 id="common-implementacion-de-la-fsm-de-simone"><code>COMMON</code>: implementación de la FSM de Simone<a class="headerlink" href="#common-implementacion-de-la-fsm-de-simone" title="Permanent link">&para;</a></h2>
<p>Vamos a proceder con la implementación de las funciones de la FSM de <em>Simone</em>.</p>
<p>Aunque el sistema <em>Simone</em> es único —no va a haber más que una FSM de este tipo—, estamos implementando una librería. Esta librería no tiene <code>main</code> y se gestionará desde el fichero <code>main.c</code> del proyecto, como veremos más adelante.</p>
<ol>
<li>
<p>Lo primero que debe aparecer es la inclusión de cabeceras. Incluya las librerías que indica la API.</p>
</li>
<li>
<p>A continuación completa la estructura <code>fsm_simone_t</code> con los campos que se muestran en la y como nos dice la API. De nuevo, <span style="color: Red"><strong>es muy importante que la máquina de estados de la simone</strong> <code>fsm_t</code> <strong>esté lo primero</strong></span>.</p>
<ul>
<li>
<p><code>*p_fsm_button</code>, <code>on_off_press_time_ms</code> y <code>pause_rgb_light_time_ms</code> son los campos que nos permitirán gestionar el botón.</p>
</li>
<li>
<p><code>*p_fsm_button</code> es un puntero a la máquina de estados del botón, <code>on_off_press_time_ms</code> es el tiempo en milisegundos para considerar que se ha metido la marcha atrás, y <code>pause_rgb_light_time_ms</code> es el tiempo en milisegundos para considerar una pulsación corta del botón para pausar el RGB light.</p>
</li>
<li>
<p><code>is_paused</code> es una variable que nos indica si el RGB light está pausado o no.</p>
</li>
<li>
<p><code>*p_fsm_ultrasound_rear</code> es el puntero a la máquina de estados del transceptor de ultrasonidos trasero.</p>
</li>
<li>
<p><code>*p_fsm_rgb_light_rear</code> es el puntero a la máquina de estados del RGB light que indica la distancia a un obstáculo por la parte trasera del coche.</p>
</li>
</ul>
</li>
<li>
<p>Documenta los campos de la estructura <code>fsm_simone_t</code>.</p>
</li>
</ol>
<p>Comenzamos con las funciones de entrada o comprobación, ı.e., aquellas que comienzan por <code>check_</code>. Codifica las funciones de entrada <code>/* State machine input functions */</code>.</p>
<ol>
<li>
<p>Codifica la funciones <code>check_on()</code>, <code>check_off()</code>, <code>check_new_measure()</code> y <code>check_pause_rgb_light()</code> como indica la API.</p>
</li>
<li>
<p>Codifica las funciones de comprobación de actividad para bajo consumo <code>check_activity()</code>, <code>check_no_activity()</code> y <code>check_activity_in_measure()</code> como indica la API. Esta última función es como <code>check_new_measure()</code>. Para que la depuración sea más sencilla, no reutilizamos el nombre de la función para saber de qué estado partimos.</p>
</li>
</ol>
<p>Sigamos con las funciones de salida, ı.e., aquellas que comienzan por <code>do_</code>. Codifica las funciones de salida <code>/* State machine output or action functions */</code>.</p>
<ol>
<li>
<p>Codifica las funciones <code>do_start_up_measure()</code>, <code>do_stop_simone()</code>, <code>do_pause_rgb_light()</code> y <code>do_rgb_light_intensity()</code> como indica la API.</p>
</li>
<li>
<p>Codifica las funciones relacionadas con el bajo consumo <code>do_sleep_off()</code>, <code>do_sleep_wait_command()</code>, <code>do_sleep_while_off()</code> y <code>do_sleep_while_on()</code> como indica la API.</p>
<p>Aunque todas ellas hacen lo mismo, conviene no reutilizar el nombre de la función para poder realizar una depuración más sencilla y saber de qué estado partimos.</p>
</li>
</ol>
<p>Vamos a codificar la tabla de transiciones de la FSM <em>Simone</em>.</p>
<ol>
<li>
<p>Codifica, justo debajo de estas funciones privadas, la tabla de transiciones de la FSM de <em>Simone</em> <code>fsm_trans_t fsm_trans_simone[]</code>.</p>
</li>
<li>
<p>Puede ser buen momento ahora para documentar todo el código con Doxygen.</p>
</li>
</ol>
<p>Como en las anteriores máquinas de estado, tenemos que codificar las funciones privadas antes de que las use alguna otra —ya que no están declaradas en la cabecera—. Ya hemos codificado las funciones de entrada y salida, ahora vamos a codificar la única que nos queda.</p>
<ol>
<li>
<p>Codifica la función <code>fsm_simone_init()</code> como se indica en la API y de forma análoga a las anteriores máquinas de estados.</p>
<p>Inicializa los punteros a las máquinas de estados de los elementos del sistema <em>Simone</em> y los tiempos de pulsación del botón para considerar una pulsación larga y corta con los datos que se pasan como argumentos. Inicializa también la variable <code>is_paused</code> a <code>false</code>.</p>
</li>
</ol>
<p>Por último, como ya hemos hecho con las anteriores máquinas de estado, vamos a implementar las funciones públicas de la FSM declaradas en la cabecera.</p>
<ol>
<li>
<p>Codifica la función <code>fsm_simone_new()</code> como se indica en la API y de forma análoga a las anteriores máquinas de estados.</p>
</li>
<li>
<p>Codifica la función <code>fsm_simone_fire()</code> como se indica en la API y de forma análoga a las anteriores máquinas de estados.</p>
</li>
<li>
<p>Haz lo propio con la función <code>fsm_simone_destroy()</code>.</p>
</li>
</ol>
<p>Compila y comprueba que no tienes errores. Si los tienes, corrígelos. Ya solo queda enlazar todo en el <code>main.c</code> y montar el HW para tener el sistema funcionando.</p>
<h2 id="sec:v2_integration">Integración SW de la FSM Simone<a class="headerlink" href="#sec:v2_integration" title="Permanent link">&para;</a></h2>
<p>Ha llegado la hora de integrar la parte SW del sistema, y depurar. Vamos a escribir las líneas de código necesarias en <code>main.c</code> para probar que funciona. <strong>Procedamos</strong>:</p>
<ol>
<li>
<p>Abre el fichero <code>main.c</code> e incluye las cabeceras necesarias.</p>
</li>
<li>
<p>Define la macro <code>SIMONE_ON_OFF_PRESS_TIME_MS</code> como indica la API para definir una pulsación larga como aquella que supere <span class="arithmatex">\(1 s\)</span>. ¡Ojo, porque el tiempo hay que darlo en <strong>milisegundos</strong>! Este es el tiempo que se debe mantener pulsado el botón para emular que se ha metido la marcha atrás.</p>
</li>
<li>
<p>Define la macro <code>SIMONE_PAUSE_RGB_LIGHT_TIME_MS</code> como indica la API para definir una pulsación corta como aquella que supere <span class="arithmatex">\(0.5 s\)</span>. ¡Ojo, porque el tiempo hay que darlo en <strong>milisegundos</strong>!</p>
</li>
<li>
<p>Después de la inicialización del sistema con la llamada a la función <code>port_system_init()</code>, crea la máquina de estados para el <em>botón</em>. Dale un nombre representativo (*e.g.*, <code>p_fsm_button</code>). Para ello llama a la función <code>fsm_button_new()</code> con los argumentos necesarios. A continuación, haz lo propio con la máquina de estados del <em>transceptor de ultrasonidos trasero</em>, y con la del <em>RGB light</em> trasero. Dales nombres representativos.</p>
</li>
<li>
<p>Crea la máquina de estados para el sistema <em>Simone</em>, puedes darle un nombre representativo (*e.g.*, <code>p_fsm_simone</code>). ¡No pases los valores "a pincho”, usa los <code>#define</code> que has creado!</p>
</li>
<li>
<p>En el bucle <code>while</code>, lanza constantemente la función <code>fsm_xxx_fire()</code>, para las máquinas de estados del <em>botón</em>, el transceptor de ultrasonidos, el RGB light y <em>Simone</em>.</p>
<p>Conviene que el sistema sea lo último porque depende de la actualización del estado de las FSM de los elementos anteriores.</p>
</li>
<li>
<p>Por último solo nos queda un aspecto meramente formal, casi académico. Cuando creamos las máquinas de estado con las funciones <code>fsm_xxx_new()</code> estamos reservando memoria de forma dinámica (con la función <code>malloc()</code>). Cuando las máquinas de estado dejan de usarse, esa memoria debe ser liberada para poder ser usada por otras partes del código. Esa liberación se hará con la llamada a la función <code>fsm_destroy()</code>.</p>
<p>Después del bucle <code>while</code> llama a <code>fsm_xxx_destroy()</code> para cada una de las FSM pasándole su tipo concreto. Esto libera la memoria de cada una de las máquinas de estado creadas: <em>botón</em>, <em>transceptor de ultrasonidos</em>, <em>RGB light</em>, y <em>Simone</em>.</p>
<p>Como se decía, esto es pura ortodoxia, porque el bucle <code>while</code> del <code>main</code> es infinito, y nunca saldrá de ahí, por lo que nuestras FSM nunca dejarán de usarse y las líneas que acabas de escribir con <code>fsm_xxx_destroy()</code> nunca se ejecutarán. No obstante, conviene que sepas que así debería hacerse.</p>
</li>
<li>
<p>Compila y comprueba que no tiene ningún error. Si tienes, corrígelos.</p>
</li>
</ol>
<h2 id="test-de-integracion-de-la-simone">Test de integración de la Simone<a class="headerlink" href="#test-de-integracion-de-la-simone" title="Permanent link">&para;</a></h2>
<h5 id="test-de-funcionalidades">Test de funcionalidades<a class="headerlink" href="#test-de-funcionalidades" title="Permanent link">&para;</a></h5>
<h5 id="_2"><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h5>
<p>Ya has probado los test de ejemplo de los distintos elementos y que se os han sido proporcionado. Ahora vamos a probar el sistema <em>Simone</em> completo. No se os va a pedir hacer un test formal, pero con todo el trabajo que has hecho, es conveniente que compruebes que todo funciona correctamente. Monta el circuito como se muestra en la . Prueba todo el sistema como en <a href="#TO-DO">el vídeo demostración Simone</a>. <strong>Procedamos</strong>:</p>
<figure><img src="../assets/notebook_imgs/pr_chapters/version_4/fritzing_simone.png" id="fig:fritzing_simone" style="width:100.0%" alt="Montaje final con el transceptor de ultrasonidos, el botón y el RGB light." /><figcaption aria-hidden="true">Montaje final con el transceptor de ultrasonidos, el botón y el RGB light.</figcaption></figure>

<ol>
<li>
<p>Conecta la placa <span style="color: RoyalBlue; font-weight: bold;">Nucleo-STM32</span> al ordenador.</p>
</li>
<li>
<p>Compila y carga el programa <code>main</code> en la placa (<strong><img alt="image" class="inline-img" src="../../assets/notebook_imgs/general/icon_debug.png" /> Clean and Debug</strong>). Comprueba que no tienes errores de compilación.</p>
</li>
<li>
<p>Prueba que el botón enciende y apaga el sistema <em>Simone</em>.</p>
</li>
<li>
<p>Prueba que las distancias se muestran correctamente en la terminal del <code>gdb-server</code>, y que el RGB light se enciende de manera acorde.</p>
</li>
<li>
<p>Prueba que una pulsación corta pausa el RGB light pero se siguen imprimiendo los mensajes de <em>log</em> en la terminal. Prueba que estando pausado, si la distancia es menor de lo indicado se enciende el LED en rojo (colisión inminente).</p>
</li>
<li>
<p>Prueba que estando pausado, puedes apagarlo.</p>
</li>
<li>
<p>Prueba que al encenderlo ya no está en pausa.</p>
</li>
<li>
<p>Prueba que, estando apagada, la <em>Simone</em> no responde toma medidas ni muestra nada en el RGB light.</p>
</li>
<li>
<p>Prueba, en general, el funcionamiento correcto como en el vídeo de demostración. Si encuentras algún error, corrígelo.</p>
</li>
</ol>
<h5 id="comprobación-de-bajo-consumo">Comprobación de bajo consumo<a class="headerlink" href="#comprobación-de-bajo-consumo" title="Permanent link">&para;</a></h5>
<h5 id="_3"><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h5>
<p>Comprobaremos que el modo <em>sleep</em> de bajo consumo se gestiona correctamente. Compila y comprueba que no tienes errores de sintaxis o de código. Para comprobar que el sistema está dormido, podemos hacerlo de dos formas:</p>
<ol>
<li>
<p>Lo más habitual —si no tenemos acceso a un depurador y si tenemos que caracterizar nuestro producto— sería hacerlo mediante la medición del consumo del microcontrolador (¡no de los elementos HW de nuestro sistema!). Para medir el consumo, ve el punto <em>"6.6 JP6 (IDD)”</em> del manual de la placa <sup id="fnref:st2020um"><a class="footnote-ref" href="#fn:st2020um">2</a></sup>. Si vas a medirlo, también deberías desconectar los <em>jumpers</em> del <code>ST-LINK</code> del conector <code>CN2</code>. Para ver el ahorro tendríamos que medirlo en ejecución sobre versión final. Esto puedes hacerlo si deseas como funcionalidad extra en la Versión 5, e incluir la información en la documentación del código (fichero <code>README.md</code>).</p>
</li>
<li>
<p>Lo que haremos para demostrar que el sistema alterna entre el modo <em>despierto</em> y <em>dormido</em> será depurando. Continúa con la depuración sin poner puntos de parada. Cuando el sistema esté inactivo, pausa la depuración y comprueba que se ha detenido en la línea de código tras la llamada a <em>wait for interrupt</em> (<code>__WFI()</code>), similar a como se muestra en la . Esto querrá decir que, efectivamente, la ejecución estaba detenida <em>esperando una interrupción</em>, se ha despertado, y ha pasado a la siguiente línea de código.</p>
</li>
</ol>
<figure><img src="../assets/notebook_imgs/pr_chapters/version_4/debug_sleep.png" id="fig:debug_sleep" style="width:100.0%" alt="Restauración del modo despierto vista en depuración." /><figcaption aria-hidden="true">Restauración del modo <em>despierto</em> vista en depuración.</figcaption></figure>

<h5 id="test-final">Test final<a class="headerlink" href="#test-final" title="Permanent link">&para;</a></h5>
<h5 id="_4"><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h5>
<p>En pro de hacer una buena documentación de un proyecto —tanto si es para un cliente como si es para los propios desarrolladores de una empresa—, es conveniente tomar imágenes y/o vídeos y presentarlas como demostración. En este caso, lo haremos mostrando una captura del osciloscopio en el que aparezca la señal <em>trigger</em> que excita el transceptor de ultrasonidos, y el eco recibido. <strong>Procedamos</strong>:</p>
<figure><img src="../assets/notebook_imgs/pr_chapters/version_4/osciloscopio_trigger_echo.png" id="fig:osciloscopio_trigger_echo" style="width:100.0%" alt="Captura de osciloscopio de la señal trigger y eco del transceptor de ultrasonidos, indicando la distancia." /><figcaption aria-hidden="true">Captura de osciloscopio de la señal <em>trigger</em> y eco del transceptor de ultrasonidos, indicando la distancia.</figcaption></figure>

<ol>
<li>
<p>Toma dos cables y con las sondas del osciloscopio conéctalos en la <em>protoboard</em> a los pines de <em>echo</em> y <em>trigger</em> del transceptor de ultrasonidos. No olvides conectar los <em>cocodrilos</em> de las sondas a la masa de la <em>protoboard</em>.</p>
</li>
<li>
<p>Configura el <em>trigger</em> del osciloscopio para que se dispare cuando se detecte un flanco de subida en el pin de eco. Ajusta el eje de tiempos hasta que veas bien en osciloscopio ambas señales correctamente. Coloca un objeto fijo delate del transceptor para jugar con la distancia que se muestra en el osciloscopio.</p>
</li>
<li>
<p>Haz que en el osciloscopio aparezcan los cursores de tiempo indicando el inicio y el fin del eco, así como el valor de la medida, como Se muestra en la .</p>
</li>
<li>
<p>Haz una captura del osciloscopio. Usa el programa del ordenador o conecta una memoria <code>USB</code> en el osciloscopio para descargar la señal. <span style="color: Red">¡No sirven fotos con el móvil!</span></p>
</li>
<li>
<p>Edita la captura con <em>Paint</em> u otro editor para escribir, según la medida indicada, a qué distancia está el objeto. Debería verse algo como lo de la . Añádela a tu <code>README.md</code>.</p>
</li>
</ol>
<p>¡Ya tenemos el sistema <em>Simone</em> funcionando! <strong>No olvides documentarlo</strong> (vídeo <a href="https://youtu.be/VC7fExJJQSY?si=YIY22n5yiqzfZuQd">"[MatrixMCU] Documentación de código con Doxygen”</a>). En la siguiente versión podrás añadir más funcionalidades a tu elección. Puedes incluir más capturas o imágenes para enriquecer la documentación.</p>
<p>Guarda una copia de su proyecto como <code>simone_v4</code> para tener un punto de partida para la siguiente versión, y una copia de seguridad por si algo falla. <strong>Esta copia súbela al buzón de entrega de la asignatura separada de la que hagas con la versión 5, que tiene otro buzón</strong>. ¡Ánimo!</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:stm322025fundamentos">
<p>Josué Pagán Ortiz. <em>Fundamentos teóricos de sistemas basados en microcontrolador STM32</em>. Universidad Politécnica de Madrid, 2024.&#160;<a class="footnote-backref" href="#fnref:stm322025fundamentos" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:stm322025fundamentos" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:st2020um">
<p>STMicroelectronics. Um1724 user manual. stm32 nucleo-64 boards. Technical Report, STMicroelectronics, 2020. URL: <a href="https://www.st.com/resource/en/user_manual/um1724-stm32-nucleo64-boards-mb1136-stmicroelectronics.pdf">https://www.st.com/resource/en/user_manual/um1724-stm32-nucleo64-boards-mb1136-stmicroelectronics.pdf</a>.&#160;<a class="footnote-backref" href="#fnref:st2020um" title="Jump back to footnote 2 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:st2020um" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>